<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en">
<head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <title>Server Side Events test. Check the manual</title>
  
  
  
  <style type='text/css'>
    body { background-color: #DDDDDD; font: 30px sans-serif; }
  </style>
  


<script type='text/javascript'>//<![CDATA[ 

INTRAEL = {
    c: 0,
    t: 0,
    init: function() {
        this.setup();
        this.evs = new EventSource("http://127.0.0.1:6661/rev" + Date.now());
        this.evs.onerror = this.error.bind(this);
        this.evs.onmessage = this.success.bind(this);
    },
    setup: function() {
        this.el = document.getElementById("el").firstChild;
    },
    success: function(e) {
        this.el.nodeValue = e.data;
    },
    error: function() {
        this.el.nodeValue = "ERROR";
        window.setTimeout(function() {
            INTRAEL.init();
        }, 5000);
    }
};

window.onload = function() {
    window.setTimeout(function() {
        INTRAEL.init();
    }, 0);
};
//]]>  

</script>


</head>
<body>
  <div id='el'>N/A</div>
  
</body>


</html>

